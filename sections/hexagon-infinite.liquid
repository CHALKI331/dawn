{% comment %}
  Infinite Hexagon Honeycomb (4 rows)
  - Displays 4 rows of gap-free, tessellated hexagons (150px x 130px).
  - Each hexagon is a clickable link to its product page.
  - Each row's content is duplicated for seamless infinite horizontal scrolling.
  - All hexagons get a random product image on load and update every 5 seconds.
{% endcomment %}

{% assign products_array = collections.all.products %}
{% capture product_data_json %}
[
  {% for product in products_array %}
    {
      "url": "{{ product.url | escape }}",
      "image": "{% if product.featured_image %}{{ product.featured_image | img_url: '400x400' }}{% else %}https://via.placeholder.com/400{% endif %}"
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{% endcapture %}

{% assign hexagons_per_row = 12 %}

<div class="hexagon-scroll-container">
  <div class="hexagon-grid">
    {% for row in (0..3) %}
      <div class="hexagon-row" data-row="{{ row }}">
        {% for i in (1..hexagons_per_row) %}
          <a href="#" class="hexagon">
            <img src="" alt="Product Image">
          </a>
        {% endfor %}
        {% for i in (1..hexagons_per_row) %}
          <a href="#" class="hexagon">
            <img src="" alt="Product Image">
          </a>
        {% endfor %}
      </div>
    {% endfor %}
  </div>
</div>

<script>
  // Parse product data from Liquid into an array.
  var productData = {{ product_data_json | strip_newlines }};
  
  // Helper: Return a random product object from productData.
  function getRandomProduct() {
    return productData[Math.floor(Math.random() * productData.length)];
  }
  
  // Update all hexagons with random product data.
  function updateAllHexagons() {
    var hexagons = document.querySelectorAll('.hexagon');
    hexagons.forEach(function(hex) {
      var product = getRandomProduct();
      hex.href = product.url;
      var img = hex.querySelector('img');
      if (img) {
        img.src = product.image;
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    updateAllHexagons(); // Set random images on page load.
    setInterval(updateAllHexagons, 5000); // Update all hexagons every 5 seconds.
  });
</script>

{% schema %}
{
  "name": "InfHexRandom",
  "settings": [],
  "presets": [
    {
      "name": "InfHexRandom",
      "category": "Custom"
    }
  ]
}
{% endschema %}
